---
noteId: 1771131447941
related:
  - "[[30 Interests/31 Programming/Go/База для собесов/Темы к собесам/Каналы]]"
  - "[[30 Interests/31 Programming/Go/База для собесов/Темы к собесам/Горутина]]"
---

```go
func main() {
	var wg sync.WaitGroup
	c := make(chan string, 3)

	for i := 0; i < 5; i++ {
		wg.Add(1)
		go func(i int) {
			defer wg.Done()
			c <- "Goroutine " + strconv.Itoa(i)
		}(i)
	}

	for {
		select {
		case v := <-c:
			fmt.Println(v)
		}
	}

	wg.Wait()
	close(c)
}
```

---

Вывод программы:

```
Goroutine 0 / рандомный порядок
Goroutine 1 / рандомный порядок
Goroutine 2 / рандомный порядок
Goroutine 3 / рандомный порядок
Goroutine 4 / рандомный порядок
fatal error: all goroutines are asleep - deadlock!
```

Можно исправить вот так: 

```go
func main() {
	var wg sync.WaitGroup
	c := make(chan string, 3)

	for i := 0; i < 5; i++ {
		wg.Add(1)
		go func(i int) {
			defer wg.Done()
			c <- "Goroutine " + strconv.Itoa(i)
		}(i)
	}

	go func() {
		wg.Wait()
		close(c)
	}()

	for v := range c {
		fmt.Println(v)
	}
}
```
